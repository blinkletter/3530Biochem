

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Michaelis-Menten Plot from HPLC Analysis &#8212; Python for Biochemistry</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Permethrin/Permethrin_MMPlot1';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../start.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/plot.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/plot.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../start.html">
                    Data Interpretation for Biochemistry
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../T2AcidBaseMath.html">Acid Equilibria with <em>Python</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="../T2Exercise.html">Acid-Base Equilibria Math</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/blinkletter/3530Biochem/blob/main/./Permethrin/Permethrin_MMPlot1.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Permethrin/Permethrin_MMPlot1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Michaelis-Menten Plot from HPLC Analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#curve-fits-with-errors-included">Curve Fits with Errors Included</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-load-data-and-calculate-means-and-errors">Step 1: Load data and calculate means and errors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-perform-curve-fit-with-errors">Step 2: Perform curve fit with errors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-plot-data-with-error-pars-and-line-fit">Step 3: Plot data with error pars and line fit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-4-and-5-do-it-all-again-with-hce2">Steps 4 and 5: Do It All Again with hCE2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-convert-to-preferred-units-and-track-errors">Step 4: Convert to preferred units and track errors</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notes-on-errors">Notes on Errors</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-initial-area-to-concentration">Converting Initial Area to Concentration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-parameters">Calculating Parameters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rinse-and-repeat">Rinse and Repeat</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="michaelis-menten-plot-from-hplc-analysis">
<h1>Michaelis-Menten Plot from HPLC Analysis<a class="headerlink" href="#michaelis-menten-plot-from-hplc-analysis" title="Permalink to this headline">#</a></h1>
<div class="section" id="curve-fits-with-errors-included">
<h2>Curve Fits with Errors Included<a class="headerlink" href="#curve-fits-with-errors-included" title="Permalink to this headline">#</a></h2>
<p>We have aliquotes of a stock solution in an enzyme assay. We have five replicates of each enzyme reaction. Below we will calculate the difference between a control and each of the experimental runs. We will get the mean value and standard deviation for the amount of the given diastereomer that is consumed after 3 hours.  I all cases the progress of the reaction is less that 5%.</p>
<p>We will then plot the michaelis-menten plots to determine the enzyme kinetic parameters. We will need to convert to appropriate units for values for <span class="math notranslate nohighlight">\(V_{max}\)</span> and <span class="math notranslate nohighlight">\(K_M\)</span>. I will convert to <span class="math notranslate nohighlight">\(\mu M/min\)</span> for <span class="math notranslate nohighlight">\(V_{max}\)</span> and <span class="math notranslate nohighlight">\(mM\)</span> for <span class="math notranslate nohighlight">\(K_M\)</span>. I will use the *uncertainties<span class="math notranslate nohighlight">\( package in \)</span>Python$ to progate errors so that the final standard deviations can be reported.</p>
<p>This will provide a rigourous and documented source for the <span class="math notranslate nohighlight">\(V_{max}\)</span> and <span class="math notranslate nohighlight">\(K_M\)</span> values and their standard deviations. You might not agree with my method but you will know exactly what I did.</p>
</div>
<div class="section" id="step-1-load-data-and-calculate-means-and-errors">
<h2>Step 1: Load data and calculate means and errors<a class="headerlink" href="#step-1-load-data-and-calculate-means-and-errors" title="Permalink to this headline">#</a></h2>
<p>The code below creates a data frame from the enzyme kinetics experiment and creates a separate data frame for each enzyme (hCE1 and hCE2) as well as the control lanes (C1 and C2).  The difference between the control peak area for PM and each experimental peak area will be calculated. Then a column for the mean and stadard deviation across each row is added. We now have a value for the amount of substrate consumed after 3 hours in terms of peak area.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;mode.chained_assignment&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>  <span class="c1">### Supress warnings about &quot;setting with copy&quot; in dataframes</span>


<span class="c1">############################</span>
<span class="c1">### Set global variables </span>
<span class="c1">############################</span>

<span class="c1">#data_path = &quot;https://raw.githubusercontent.com/blinkletter/3530Biochem/main/Permethrin/&quot;</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span>

<span class="n">image_path</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/blinkletter/3530Biochem/main/Permethrin/images/&quot;</span>

<span class="n">github_styles_location</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/blinkletter/LFER-QSAR/main/styles/&quot;</span>

<span class="c1">#############################</span>
<span class="c1">### Choose data</span>
<span class="c1">#############################</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;S-CIS.csv&quot;</span>  <span class="c1">### &quot;R-CIS.csv&quot; or &quot;S-CIS.csv&quot; or &quot;R-TRANS.csv&quot; or &quot;S-TRANS.csv&quot;</span>

<span class="c1">################################################################################</span>
<span class="c1">### Read data set. The fields are separated by commas; comments are enabled  </span>
<span class="c1">################################################################################</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_path</span> <span class="o">+</span> <span class="n">file_name</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;Vol (/uL)&quot;</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">################################################################################</span>
<span class="c1">### Calculate differences for hCE1 and get mean and st_dev</span>
<span class="c1">################################################################################</span>

<span class="n">df_hCE1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;hCE1-1&quot;</span><span class="p">,</span> <span class="s2">&quot;hCE1-2&quot;</span><span class="p">,</span> <span class="s2">&quot;hCE1-3&quot;</span><span class="p">,</span> <span class="s2">&quot;hCE1-4&quot;</span><span class="p">,</span> <span class="s2">&quot;hCE1-5&quot;</span><span class="p">]]</span>   <span class="c1"># Create dataframe for enzyme #1</span>
<span class="n">start_PM</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;C2&quot;</span><span class="p">]</span>                                                <span class="c1"># Use control lane as initial concentration</span>
<span class="n">df_hCE1</span> <span class="o">=</span> <span class="o">-</span><span class="n">df_hCE1</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">start_PM</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;rows&#39;</span><span class="p">)</span>                 <span class="c1"># subtract init. conc. from each lane of enzyme #1 results dataframe</span>
                                                                   <span class="c1"># This dataframe now has difference in area between start and time point.</span>
<span class="n">means</span> <span class="o">=</span> <span class="n">df_hCE1</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>      <span class="c1"># get mean of each row</span>
<span class="n">stdevs</span> <span class="o">=</span> <span class="n">df_hCE1</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>      <span class="c1"># get stdev of each row</span>

<span class="n">df_hCE1</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">means</span>
<span class="n">df_hCE1</span><span class="p">[</span><span class="s2">&quot;stdev&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stdevs</span>


<span class="c1">################################################################################</span>
<span class="c1">### Calculate differences for hCE2 and get mean and st_dev</span>
<span class="c1">################################################################################</span>

<span class="n">df_hCE2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;hCE2-1&quot;</span><span class="p">,</span> <span class="s2">&quot;hCE2-2&quot;</span><span class="p">,</span> <span class="s2">&quot;hCE2-3&quot;</span><span class="p">,</span> <span class="s2">&quot;hCE2-4&quot;</span><span class="p">,</span> <span class="s2">&quot;hCE2-5&quot;</span><span class="p">]]</span>    <span class="c1"># Create dataframe for enzyme #1</span>
<span class="n">start_PM</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;C2&quot;</span><span class="p">]</span>                                                 <span class="c1"># Use control lane as initial concentration</span>
<span class="n">df_hCE2</span> <span class="o">=</span> <span class="o">-</span><span class="n">df_hCE2</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">start_PM</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;rows&#39;</span><span class="p">)</span>                  <span class="c1"># subtract init. conc. from each lane of enzyme #1 results dataframe</span>
                                                                    <span class="c1"># This dataframe now has difference in area between start and time point.</span>
<span class="n">means</span> <span class="o">=</span> <span class="n">df_hCE2</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>      <span class="c1"># get mean of each row</span>
<span class="n">stdevs</span> <span class="o">=</span> <span class="n">df_hCE2</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>      <span class="c1"># get stdev of each row</span>

<span class="n">df_hCE2</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">means</span>
<span class="n">df_hCE2</span><span class="p">[</span><span class="s2">&quot;stdev&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stdevs</span>


<span class="c1">################################################################################</span>
<span class="c1">### Show the dataframes</span>
<span class="c1">################################################################################</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">This is the raw data that was read in from the file&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Below is the peak areas with the &#39;C2&#39; control (initial concentration) subtracted. </span><span class="se">\</span>
<span class="s2">      </span><span class="se">\n</span><span class="s2">These is the five lanes with the CE1 version of the enzyme.&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_hCE1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Below is the peak areas with the &#39;C2&#39; control (initial concentration) subtracted.  </span><span class="se">\</span>
<span class="s2">      </span><span class="se">\n</span><span class="s2">These is the five lanes with the CE2 version of the enzyme.&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_hCE2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This is the raw data that was read in from the file
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C1</th>
      <th>C2</th>
      <th>hCE1-1</th>
      <th>hCE1-2</th>
      <th>hCE1-3</th>
      <th>hCE1-4</th>
      <th>hCE1-5</th>
      <th>hCE2-1</th>
      <th>hCE2-2</th>
      <th>hCE2-3</th>
      <th>hCE2-4</th>
      <th>hCE2-5</th>
    </tr>
    <tr>
      <th>Vol (/uL)</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>111977</td>
      <td>108994</td>
      <td>104079</td>
      <td>103897</td>
      <td>107203</td>
      <td>107625</td>
      <td>105757</td>
      <td>105611</td>
      <td>104484</td>
      <td>104599</td>
      <td>102877</td>
      <td>102259</td>
    </tr>
    <tr>
      <th>5</th>
      <td>277785</td>
      <td>281063</td>
      <td>262401</td>
      <td>263053</td>
      <td>266434</td>
      <td>262604</td>
      <td>265124</td>
      <td>264293</td>
      <td>261267</td>
      <td>261035</td>
      <td>261614</td>
      <td>261516</td>
    </tr>
    <tr>
      <th>7</th>
      <td>390377</td>
      <td>387970</td>
      <td>369001</td>
      <td>370362</td>
      <td>372532</td>
      <td>368867</td>
      <td>372287</td>
      <td>371541</td>
      <td>369266</td>
      <td>372355</td>
      <td>370024</td>
      <td>368156</td>
    </tr>
    <tr>
      <th>10</th>
      <td>557272</td>
      <td>558531</td>
      <td>530512</td>
      <td>533991</td>
      <td>533386</td>
      <td>529888</td>
      <td>531014</td>
      <td>534361</td>
      <td>531448</td>
      <td>531491</td>
      <td>535866</td>
      <td>532352</td>
    </tr>
    <tr>
      <th>30</th>
      <td>1672202</td>
      <td>1671218</td>
      <td>1623730</td>
      <td>1621399</td>
      <td>1623681</td>
      <td>1622875</td>
      <td>1621065</td>
      <td>1636445</td>
      <td>1636464</td>
      <td>1633738</td>
      <td>1638858</td>
      <td>1635164</td>
    </tr>
    <tr>
      <th>50</th>
      <td>2784245</td>
      <td>2787453</td>
      <td>2726625</td>
      <td>2724999</td>
      <td>2727832</td>
      <td>2722879</td>
      <td>2726229</td>
      <td>2744340</td>
      <td>2745959</td>
      <td>2745358</td>
      <td>2746406</td>
      <td>2747136</td>
    </tr>
    <tr>
      <th>100</th>
      <td>5572945</td>
      <td>5570797</td>
      <td>5497669</td>
      <td>5496082</td>
      <td>5500820</td>
      <td>5498028</td>
      <td>5497174</td>
      <td>5529947</td>
      <td>5529167</td>
      <td>5529675</td>
      <td>5530672</td>
      <td>5529079</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Below is the peak areas with the &#39;C2&#39; control (initial concentration) subtracted.       
These is the five lanes with the CE1 version of the enzyme.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hCE1-1</th>
      <th>hCE1-2</th>
      <th>hCE1-3</th>
      <th>hCE1-4</th>
      <th>hCE1-5</th>
      <th>mean</th>
      <th>stdev</th>
    </tr>
    <tr>
      <th>Vol (/uL)</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>4915</td>
      <td>5097</td>
      <td>1791</td>
      <td>1369</td>
      <td>3237</td>
      <td>3281.8</td>
      <td>1720.871059</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18662</td>
      <td>18010</td>
      <td>14629</td>
      <td>18459</td>
      <td>15939</td>
      <td>17139.8</td>
      <td>1772.051551</td>
    </tr>
    <tr>
      <th>7</th>
      <td>18969</td>
      <td>17608</td>
      <td>15438</td>
      <td>19103</td>
      <td>15683</td>
      <td>17360.2</td>
      <td>1746.056041</td>
    </tr>
    <tr>
      <th>10</th>
      <td>28019</td>
      <td>24540</td>
      <td>25145</td>
      <td>28643</td>
      <td>27517</td>
      <td>26772.8</td>
      <td>1819.314761</td>
    </tr>
    <tr>
      <th>30</th>
      <td>47488</td>
      <td>49819</td>
      <td>47537</td>
      <td>48343</td>
      <td>50153</td>
      <td>48668.0</td>
      <td>1255.708167</td>
    </tr>
    <tr>
      <th>50</th>
      <td>60828</td>
      <td>62454</td>
      <td>59621</td>
      <td>64574</td>
      <td>61224</td>
      <td>61740.2</td>
      <td>1879.462210</td>
    </tr>
    <tr>
      <th>100</th>
      <td>73128</td>
      <td>74715</td>
      <td>69977</td>
      <td>72769</td>
      <td>73623</td>
      <td>72842.4</td>
      <td>1761.635547</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Below is the peak areas with the &#39;C2&#39; control (initial concentration) subtracted.        
These is the five lanes with the CE2 version of the enzyme.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hCE2-1</th>
      <th>hCE2-2</th>
      <th>hCE2-3</th>
      <th>hCE2-4</th>
      <th>hCE2-5</th>
      <th>mean</th>
      <th>stdev</th>
    </tr>
    <tr>
      <th>Vol (/uL)</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3383</td>
      <td>4510</td>
      <td>4395</td>
      <td>6117</td>
      <td>6735</td>
      <td>5028.0</td>
      <td>1367.004755</td>
    </tr>
    <tr>
      <th>5</th>
      <td>16770</td>
      <td>19796</td>
      <td>20028</td>
      <td>19449</td>
      <td>19547</td>
      <td>19118.0</td>
      <td>1331.774193</td>
    </tr>
    <tr>
      <th>7</th>
      <td>16429</td>
      <td>18704</td>
      <td>15615</td>
      <td>17946</td>
      <td>19814</td>
      <td>17701.6</td>
      <td>1695.595854</td>
    </tr>
    <tr>
      <th>10</th>
      <td>24170</td>
      <td>27083</td>
      <td>27040</td>
      <td>22665</td>
      <td>26179</td>
      <td>25427.4</td>
      <td>1944.112985</td>
    </tr>
    <tr>
      <th>30</th>
      <td>34773</td>
      <td>34754</td>
      <td>37480</td>
      <td>32360</td>
      <td>36054</td>
      <td>35084.2</td>
      <td>1891.263652</td>
    </tr>
    <tr>
      <th>50</th>
      <td>43113</td>
      <td>41494</td>
      <td>42095</td>
      <td>41047</td>
      <td>40317</td>
      <td>41613.2</td>
      <td>1060.242519</td>
    </tr>
    <tr>
      <th>100</th>
      <td>40850</td>
      <td>41630</td>
      <td>41122</td>
      <td>40125</td>
      <td>41718</td>
      <td>41089.0</td>
      <td>647.268878</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="step-2-perform-curve-fit-with-errors">
<h2>Step 2: Perform curve fit with errors<a class="headerlink" href="#step-2-perform-curve-fit-with-errors" title="Permalink to this headline">#</a></h2>
<p>The code below perform a curve fit that includes the errors in each data point (using the standard deviations as the errors). A slope with a standard deviation will be obtained.</p>
<p>I fit the data to the following linear relationship: $<span class="math notranslate nohighlight">\( y = V_{max}\frac{x}{x + K_M} \)</span><span class="math notranslate nohighlight">\( where \)</span>y<span class="math notranslate nohighlight">\( is the area, \)</span>x<span class="math notranslate nohighlight">\( is the volume of stock solution in each experiment and \)</span>y$ is the area difference after 3 hours.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1">### Assign arrays of data to x, y, and standard deviations</span>
<span class="c1">################################################################################</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">df_hCE1</span><span class="o">.</span><span class="n">index</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_hCE1</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span>
<span class="n">stdev</span> <span class="o">=</span> <span class="n">df_hCE1</span><span class="p">[</span><span class="s2">&quot;stdev&quot;</span><span class="p">]</span>

<span class="c1">################################################################################</span>
<span class="c1">### Linear curve fit on the collected x,y data</span>
<span class="c1">################################################################################</span>

<span class="c1">### Create functions that describe linear line fits</span>

<span class="k">def</span> <span class="nf">MM_fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Vmax</span><span class="p">,</span> <span class="n">KM</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Vmax</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">KM</span><span class="p">)</span>


<span class="c1">### Perform curve fit using function of choice. Use &#39;linear&#39; or &#39;linear0&#39;</span>

<span class="n">param</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">MM_fit</span><span class="p">,</span>              <span class="c1">### use &#39;linear&#39; or &#39;linear0&#39;</span>
                        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>                <span class="c1">### The day for the fit</span>
                        <span class="n">sigma</span> <span class="o">=</span> <span class="n">stdev</span><span class="p">,</span>       <span class="c1">### Array of errors for each data point</span>
                        <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">### Errors are values, not factors.</span>
                        <span class="n">bounds</span><span class="o">=</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
                        <span class="p">)</span>

<span class="n">perr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov</span><span class="p">))</span>  <span class="c1">### Calculate st_devs for line fit from covariance matrix</span>


<span class="c1">### Use with &#39;linear0&#39; curve fit. </span>

<span class="n">Vmax1</span><span class="p">,</span> <span class="n">KM1</span> <span class="o">=</span> <span class="n">param</span>             <span class="c1">### param is an array. Vmax is first item and KM is the second.</span>
<span class="n">Vmax1_stdev</span><span class="p">,</span> <span class="n">KM1_stdev</span> <span class="o">=</span> <span class="n">perr</span>  

<span class="c1">#print(f&quot;Line is y = ({slope:0.2f} +/- {slope_stdev:0.2f})x&quot;)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Vmax1</span><span class="p">,</span><span class="n">Vmax1_stdev</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">KM1</span><span class="p">,</span><span class="n">KM1_stdev</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>92782.8318166578 3368.861993951713
26.651339592485705 2.3734667101876306
Int64Index([2, 5, 7, 10, 30, 50, 100], dtype=&#39;int64&#39;, name=&#39;Vol (/uL)&#39;)
Vol (/uL)
2       3281.8
5      17139.8
7      17360.2
10     26772.8
30     48668.0
50     61740.2
100    72842.4
Name: mean, dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="step-3-plot-data-with-error-pars-and-line-fit">
<h2>Step 3: Plot data with error pars and line fit<a class="headerlink" href="#step-3-plot-data-with-error-pars-and-line-fit" title="Permalink to this headline">#</a></h2>
<p>The code below will plot the mean area for the peak area differences in our five experiments (with error bars) against the stock solution volume.  The error bars are created using the standard deviations for each mean. A Michaelis-Menten is plotted using the curve fit data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##################################################</span>
<span class="c1">### Setup a figure and choose a style for plot</span>
<span class="c1">##################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">github_styles_location</span> <span class="o">+</span> <span class="s2">&quot;tufte.mplstyle&quot;</span><span class="p">)</span>        
<span class="c1">#plt.style.use(github_styles_location + &quot;S2_classic2.mplstyle&quot;)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  

<span class="c1">########################</span>
<span class="c1">### Plot the data    ###</span>
<span class="c1">########################</span>

<span class="c1">### Plot data points</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">96</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>


<span class="c1">### Add error bars (command could be all on one line as above, but is separated for adding comments)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>             <span class="c1">### data</span>
            <span class="n">yerr</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">stdev</span><span class="p">,</span> <span class="c1">### y errors</span>
            <span class="n">xerr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>      <span class="c1">### x errors</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span>     <span class="c1">### Data marker style</span>
            <span class="n">ecolor</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="c1">### Color of error bars</span>
            <span class="n">elinewidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="c1">### Thickness of vertical bar</span>
            <span class="n">capsize</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>      <span class="c1">### width of cap (in points)</span>
            <span class="n">capthick</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>   <span class="c1">### thickness of cap line</span>
            <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>             <span class="c1">### data</span>
            <span class="n">yerr</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">stdev</span><span class="p">,</span> <span class="c1">### y errors</span>
            <span class="n">xerr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>      <span class="c1">### x errors</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span>     <span class="c1">### Data marker style</span>
            <span class="n">ecolor</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="c1">### Color of error bars</span>
            <span class="n">elinewidth</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="c1">### Thickness of vertical bar</span>
            <span class="n">capsize</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>      <span class="c1">### width of cap (in points)</span>
            <span class="n">capthick</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>   <span class="c1">### thickness of cap line</span>
            <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>


<span class="n">last_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>     <span class="c1">### Convert row index into array and choose largest value</span>
<span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_x</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1">### Create x-axis for ploting caluclated line fit</span>


<span class="c1">### Plot calculated line</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">MM_fit</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">Vmax1</span><span class="p">,</span> <span class="n">KM1</span><span class="p">),</span>    <span class="c1">### x, y calculated data for line</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>      <span class="c1">### solid black line</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1">### line thickness and layer (0 is farthest back)</span>
        <span class="p">)</span>


<span class="c1">############################</span>
<span class="c1">### Set labels and scale </span>
<span class="c1">############################</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Michaelis-Menten Plot&quot;</span><span class="p">,</span>
        <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Peak Area&quot;</span><span class="p">,</span> 
        <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Injection Volume / $\mu L$&quot;</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">ylim</span><span class="o">=</span><span class="mi">0</span>
      <span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    <span class="c1"># add 7% empty space around outside of plot area   </span>

<span class="c1">#############################</span>
<span class="c1">### Output the final plot </span>
<span class="c1">#############################</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plot_hCE1.pdf&quot;</span><span class="p">)</span>   <span class="c1">### use this to save the figure in PDF format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>                <span class="c1">### output the combined plot plots</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vmax is (</span><span class="si">{</span><span class="n">Vmax1</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">Vmax1_stdev</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">) Area units/3 hours&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KM is (</span><span class="si">{</span><span class="n">KM1</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">KM1_stdev</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">) uL injection volume&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/50f2caebdadd35efc747945b1782ed02a351c6a4dec2c381eb9265cbe5e94a67.png" src="../_images/50f2caebdadd35efc747945b1782ed02a351c6a4dec2c381eb9265cbe5e94a67.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Vmax is (92782.83 +/- 3368.86) Area units/3 hours
KM is (26.65 +/- 2.37) uL injection volume
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="steps-4-and-5-do-it-all-again-with-hce2">
<h2>Steps 4 and 5: Do It All Again with hCE2<a class="headerlink" href="#steps-4-and-5-do-it-all-again-with-hce2" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1">### Assign arrays of data to x, y, and standard deviations</span>
<span class="c1">################################################################################</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">df_hCE2</span><span class="o">.</span><span class="n">index</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_hCE2</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span>
<span class="n">stdev</span> <span class="o">=</span> <span class="n">df_hCE2</span><span class="p">[</span><span class="s2">&quot;stdev&quot;</span><span class="p">]</span>

<span class="c1">################################################################################</span>
<span class="c1">### Linear curve fit on the collected x,y data</span>
<span class="c1">################################################################################</span>

<span class="c1">### Create functions that describe linear line fits</span>

<span class="k">def</span> <span class="nf">MM_fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Vmax</span><span class="p">,</span> <span class="n">KM</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Vmax</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">KM</span><span class="p">)</span>


<span class="c1">### Perform curve fit using function of choice. Use &#39;linear&#39; or &#39;linear0&#39;</span>

<span class="n">param</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">MM_fit</span><span class="p">,</span>              <span class="c1">### use &#39;linear&#39; or &#39;linear0&#39;</span>
                        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>                <span class="c1">### The day for the fit</span>
                        <span class="n">sigma</span> <span class="o">=</span> <span class="n">stdev</span><span class="p">,</span>       <span class="c1">### Array of errors for each data point</span>
                        <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">### Errors are values, not factors.</span>
                        <span class="n">bounds</span><span class="o">=</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
                        <span class="p">)</span>

<span class="n">perr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov</span><span class="p">))</span>  <span class="c1">### Calculate st_devs for line fit from covariance matrix</span>


<span class="c1">### Use with &#39;linear0&#39; curve fit. </span>

<span class="n">Vmax2</span><span class="p">,</span> <span class="n">KM2</span> <span class="o">=</span> <span class="n">param</span>             <span class="c1">### param is an array. Vmax is first item and KM is the second.</span>
<span class="n">Vmax2_stdev</span><span class="p">,</span> <span class="n">KM2_stdev</span> <span class="o">=</span> <span class="n">perr</span>  

<span class="nb">print</span><span class="p">(</span><span class="n">Vmax2</span><span class="p">,</span><span class="n">Vmax2_stdev</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">KM2</span><span class="p">,</span><span class="n">KM2_stdev</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>45565.797544615394 823.3985326575346
8.631090938764096 0.8044860511691818
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##################################################</span>
<span class="c1">### Setup a figure and choose a style for plot</span>
<span class="c1">##################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">github_styles_location</span> <span class="o">+</span> <span class="s2">&quot;tufte.mplstyle&quot;</span><span class="p">)</span>        
<span class="c1">#plt.style.use(github_styles_location + &quot;S2_classic2.mplstyle&quot;)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  

<span class="c1">########################</span>
<span class="c1">### Plot the data    ###</span>
<span class="c1">########################</span>

<span class="c1">### Plot data points</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">96</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>


<span class="c1">### Add error bars (command could be all on one line as above, but is separated for adding comments)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>             <span class="c1">### data</span>
            <span class="n">yerr</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">stdev</span><span class="p">,</span> <span class="c1">### y errors</span>
            <span class="n">xerr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>      <span class="c1">### x errors</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span>     <span class="c1">### Data marker style</span>
            <span class="n">ecolor</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="c1">### Color of error bars</span>
            <span class="n">elinewidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="c1">### Thickness of vertical bar</span>
            <span class="n">capsize</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>      <span class="c1">### width of cap (in points)</span>
            <span class="n">capthick</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>   <span class="c1">### thickness of cap line</span>
            <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>             <span class="c1">### data</span>
            <span class="n">yerr</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">stdev</span><span class="p">,</span> <span class="c1">### y errors</span>
            <span class="n">xerr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>      <span class="c1">### x errors</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span>     <span class="c1">### Data marker style</span>
            <span class="n">ecolor</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="c1">### Color of error bars</span>
            <span class="n">elinewidth</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="c1">### Thickness of vertical bar</span>
            <span class="n">capsize</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>      <span class="c1">### width of cap (in points)</span>
            <span class="n">capthick</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>   <span class="c1">### thickness of cap line</span>
            <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>


<span class="n">last_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>     <span class="c1">### Convert row index into array and choose largest value</span>
<span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">last_x</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1">### Create x-axis for ploting caluclated line fit</span>


<span class="c1">### Plot calculated line</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">MM_fit</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">Vmax2</span><span class="p">,</span> <span class="n">KM2</span><span class="p">),</span>    <span class="c1">### x, y calculated data for line</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>      <span class="c1">### solid black line</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1">### line thickness and layer (0 is farthest back)</span>
        <span class="p">)</span>


<span class="c1">############################</span>
<span class="c1">### Set labels and scale </span>
<span class="c1">############################</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Michaelis-Menten Plot&quot;</span><span class="p">,</span>
        <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Peak Area&quot;</span><span class="p">,</span> 
        <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Injection Volume / $\mu L$&quot;</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">ylim</span><span class="o">=</span><span class="mi">0</span>
      <span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    <span class="c1"># add 7% empty space around outside of plot area   </span>

<span class="c1">#############################</span>
<span class="c1">### Output the final plot </span>
<span class="c1">#############################</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plot_hCE2.pdf&quot;</span><span class="p">)</span>   <span class="c1">### use this to save the figure in PDF format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>                <span class="c1">### output the combined plot plots</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vmax is (</span><span class="si">{</span><span class="n">Vmax2</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">Vmax2_stdev</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">) Area units/3 hours&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KM is (</span><span class="si">{</span><span class="n">KM2</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">KM2_stdev</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">) uL injection volume&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/adf442486bc7ad4fcd4a26a156ebf7241beed56379b2d0e22c9261603138fc1c.png" src="../_images/adf442486bc7ad4fcd4a26a156ebf7241beed56379b2d0e22c9261603138fc1c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Vmax is (45565.80 +/- 823.40) Area units/3 hours
KM is (8.63 +/- 0.80) uL injection volume
</pre></div>
</div>
</div>
</div>
<div class="section" id="step-4-convert-to-preferred-units-and-track-errors">
<h3>Step 4: Convert to preferred units and track errors<a class="headerlink" href="#step-4-convert-to-preferred-units-and-track-errors" title="Permalink to this headline">#</a></h3>
<p>The code below will use the <em>uncertainties</em> package in the <em>Python</em> library to perform calculations with error propagation. We wont have to know how to propagate errors correctly but anyone examining my work will be able to see exactly what I did.</p>
<p>The <em>uncertainties</em> package is not included in the <em>Python</em> standard library and so must be installed using the code cell below. Only run this cell once. It wont hurt if you run it again; it just wastes time.</p>
<p>The code cell underneath the install code will import our slope and standard deviation from the line fit and create a ufloat object.  This is a number that includes the uncertainty. Observe the ways I printed it out.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">####################################</span>
<span class="c1">### Install UNCERTAINTIES package </span>
<span class="c1">####################################</span>

<span class="c1">#%pip install uncertainties</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="notes-on-errors">
<h4>Notes on Errors<a class="headerlink" href="#notes-on-errors" title="Permalink to this headline">#</a></h4>
<p>We now can state the other values. We dont have a population of measurements to determine the standard deviations for these values, we just have estimated errors based on experience and manufacturer information.</p>
<p>The automatic sample <strong>injector</strong> is reported to have an accuracy of <span class="math notranslate nohighlight">\(\pm 0.1 \, \mu L\)</span></p>
<p>When <strong>weighing</strong> the permethrin sample I used a <strong>balance</strong> with an accuracy of <span class="math notranslate nohighlight">\(\pm 0.1 \, mg\)</span></p>
<p>The <strong>pipette</strong> that I used to transfer the solvent for the sample solution has an accuracy of <span class="math notranslate nohighlight">\(\pm 0.01 \, mL\)</span></p>
<p>The <strong>pipette</strong> that I used to transfer the stock solution to each sample has an accuracy of <span class="math notranslate nohighlight">\(\pm 0.001 \, mL\)</span></p>
<p>Observe the features of the <em>uncertanties</em> package that I used to create these ufloat values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">uncertainties</span> <span class="k">as</span> <span class="nn">un</span>
<span class="kn">from</span> <span class="nn">uncertainties</span> <span class="kn">import</span> <span class="n">unumpy</span> <span class="k">as</span> <span class="n">unp</span>
<span class="kn">from</span> <span class="nn">uncertainties</span> <span class="kn">import</span> <span class="n">umath</span> <span class="k">as</span> <span class="n">um</span>


<span class="c1">####################################################################################</span>
<span class="c1">### Create calibration coefficient as a floating point number with uncertainty</span>
<span class="c1">####################################################################################</span>

<span class="n">coeff</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="s2">&quot;640.09+/-32.18&quot;</span><span class="p">)</span>   <span class="c1"># Area / umole in sample.</span>

<span class="c1">##################################</span>
<span class="c1">### Print out the ufloat value</span>
<span class="c1">##################################</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The calibration coefficient is </span><span class="si">{</span><span class="n">coeff</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> per microlitre&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Input</span> <span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">uncertainties</span> <span class="k">as</span> <span class="nn">un</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">uncertainties</span> <span class="kn">import</span> <span class="n">unumpy</span> <span class="k">as</span> <span class="n">unp</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">from</span> <span class="nn">uncertainties</span> <span class="kn">import</span> <span class="n">umath</span> <span class="k">as</span> <span class="n">um</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;uncertainties&#39;
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="converting-initial-area-to-concentration">
<h3>Converting Initial Area to Concentration<a class="headerlink" href="#converting-initial-area-to-concentration" title="Permalink to this headline">#</a></h3>
<p>The C2 control series is used to define the initial concentration. It is a tube where no enzyme was present during the time of the reaction. We have previously measured that hydrolysis at pH 7.0 is insignificant over the time frame of 3 hours. The amount of one particular diastereomer will be some fraction of the total permethrin concentration.  The orrelation coefficient was calculated fro the total permethrin concentration. (In hindsite I should have treated each of the four peaks separately rather than combining them. The data is still on the computer of the HPLC; perhaps I should go back and recalculate?)</p>
<p>Rather than dig up my old data, I will move forward with the calibration coefficient and the measured areas in this experiment to determine a new factor that will convert the volume of the permethrin aliquote to concentration in the reaction sample.</p>
<p>First we note the concentration of the stock solution.  It is 2 g in 1 mL DMSO. that is a high concentration, but it needs to be high so that a minumum amount of DMSO solution is added in each experimental sample. Enzymes prefer water and we want to use the minimum amount of DMSO cosolvent.</p>
<p>We can calculate the expected concentration of total eprmethrin in each tube and plot it against the measured amount of the given diastereomer (using the calibration coefficient and the area for the diastereomer peak). The slope of the line will define this factor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">volume_stock</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="s2">&quot;1+/-0.01&quot;</span><span class="p">)</span>    <span class="c1">### volume of stock solution is 2 mL; creating ufloat from text</span>
<span class="n">mass</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">)</span>                   <span class="c1">### mass is 2 g; creating ufloat from list</span>
<span class="n">molar_mass</span> <span class="o">=</span> <span class="mf">391.29</span>                       <span class="c1">### molar mass of permethrin is 391.29 g/mole; no uncertainty here</span>
<span class="n">volume_reaction</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="s2">&quot;1+/-0.010&quot;</span><span class="p">)</span>
<span class="n">injection_volume</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="s2">&quot;0.100+/-0.0001&quot;</span><span class="p">)</span>


<span class="n">conc_stock_soln</span> <span class="o">=</span> <span class="p">(</span><span class="n">mass</span> <span class="o">/</span> <span class="n">molar_mass</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">volume_stock</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">1000</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Concentration of stock solution is </span><span class="si">{</span><span class="n">conc_stock_soln</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">aliquotes</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">uarray</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>   <span class="c1">### uL injected into each 1 mL reaction vessel</span>
<span class="n">conc_pm_reaction</span> <span class="o">=</span> <span class="p">(</span><span class="n">aliquotes</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="n">conc_stock_soln</span> <span class="o">/</span> <span class="p">(</span><span class="n">volume_reaction</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1">#print(aliquotes)</span>

<span class="c1">#print(&quot;\n uarray for concentrations of total PM in experiment wells&quot;)</span>
<span class="c1">#print(conc_pm_reaction)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Calculated Expected Total Area for all Permethrins&quot;</span><span class="p">)</span>
<span class="n">moles_injected</span> <span class="o">=</span> <span class="n">conc_pm_reaction</span> <span class="o">*</span> <span class="p">(</span><span class="n">injection_volume</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">expected_total_area</span> <span class="o">=</span> <span class="n">moles_injected</span> <span class="o">*</span> <span class="n">coeff</span> <span class="o">*</span> <span class="mi">1000000</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">expected_total_area</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Observed Area for a chosen diastereomer&quot;</span><span class="p">)</span>
<span class="n">observed_area_this_diastereomer</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;C2&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">observed_area_this_diastereomer</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">volume_stock</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="s2">&quot;1+/-0.01&quot;</span><span class="p">)</span>    <span class="c1">### volume of stock solution is 2 mL; creating ufloat from text</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">mass</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">)</span>                   <span class="c1">### mass is 2 g; creating ufloat from list</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">molar_mass</span> <span class="o">=</span> <span class="mf">391.29</span>                       <span class="c1">### molar mass of permethrin is 391.29 g/mole; no uncertainty here</span>

<span class="ne">NameError</span>: name &#39;un&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1">### Assign arrays of data to x, y, and standard deviations</span>
<span class="c1">################################################################################</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">observed_area_this_diastereomer</span><span class="o">/</span><span class="mf">1e6</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">expected_total_area</span><span class="p">)</span><span class="o">/</span><span class="mf">1e6</span>
<span class="n">stdev</span> <span class="o">=</span> <span class="n">unp</span><span class="o">.</span><span class="n">std_devs</span><span class="p">(</span><span class="n">expected_total_area</span><span class="p">)</span><span class="o">/</span><span class="mf">1e6</span>

<span class="c1">################################################################################</span>
<span class="c1">### Linear curve fit on the collected x,y data</span>
<span class="c1">################################################################################</span>

<span class="c1">### Create functions that describe linear line fits</span>

<span class="k">def</span> <span class="nf">linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>

<span class="k">def</span> <span class="nf">linear0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">slope</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> 

<span class="c1">### Perform curve fit using function of choice. Use &#39;linear&#39; or &#39;linear0&#39;</span>

<span class="n">param</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">linear0</span><span class="p">,</span>             <span class="c1">### use &#39;linear&#39; or &#39;linear0&#39;</span>
                        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>                <span class="c1">### The day for the fit</span>
                        <span class="n">sigma</span> <span class="o">=</span> <span class="n">stdev</span><span class="p">,</span>       <span class="c1">### Array of errors for each data point</span>
                        <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">True</span>  <span class="c1">### Errors are values, not factors.</span>
                        <span class="p">)</span>

<span class="n">perr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov</span><span class="p">))</span>  <span class="c1">### Calculate st_devs for line fit from covariance matrix</span>


<span class="c1">### Use with &#39;linear0&#39; curve fit. </span>

<span class="n">slope</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>       <span class="c1">### param is an array and slope is the first (or only) entry</span>
<span class="n">slope_stdev</span> <span class="o">=</span> <span class="n">perr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">### param is an array and slope is the first (or only) entry</span>

<span class="c1">#print(f&quot;Line is y = ({slope:0.2f} +/- {slope_stdev:0.2f})x&quot;)</span>

<span class="c1">##################################################</span>
<span class="c1">### Setup a figure and choose a style for plot</span>
<span class="c1">##################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">github_styles_location</span> <span class="o">+</span> <span class="s2">&quot;tufte.mplstyle&quot;</span><span class="p">)</span>        
<span class="c1">#plt.style.use(github_styles_location + &quot;S2_classic2.mplstyle&quot;)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  

<span class="c1">########################</span>
<span class="c1">### Plot the data    ###</span>
<span class="c1">########################</span>

<span class="c1">### Plot data points</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">96</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>


<span class="c1">### Add error bars (command could be all on one line as above, but is separated for adding comments)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>             <span class="c1">### data</span>
            <span class="n">yerr</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">stdev</span><span class="p">,</span> <span class="c1">### y errors</span>
            <span class="n">xerr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>      <span class="c1">### x errors</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span>     <span class="c1">### Data marker style</span>
            <span class="n">ecolor</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="c1">### Color of error bars</span>
            <span class="n">elinewidth</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="c1">### Thickness of vertical bar</span>
            <span class="n">capsize</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>      <span class="c1">### width of cap (in points)</span>
            <span class="n">capthick</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>   <span class="c1">### thickness of cap line</span>
            <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>


<span class="n">last_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>     <span class="c1">### Convert row index into array and choose largest value</span>
<span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_x</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1">### Create x-axis for ploting caluclated line fit</span>

<span class="c1">### Plot calculated line</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">x_axis</span> <span class="o">*</span> <span class="p">(</span><span class="n">slope</span><span class="p">),</span>    <span class="c1">### x, y calculated data for line</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>      <span class="c1">### solid black line</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1">### line thickness and layer (0 is farthest back)</span>
        <span class="p">)</span>


<span class="c1">############################</span>
<span class="c1">### Set labels and scale </span>
<span class="c1">############################</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Calibration Correction&quot;</span><span class="p">,</span>
        <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Calculated Total Peak Area&quot;</span><span class="p">,</span> 
        <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Measured Peak Area for Diastereomer&quot;</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">ylim</span><span class="o">=</span><span class="mi">0</span>
      <span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    <span class="c1"># add 7% empty space around outside of plot area   </span>

<span class="c1">#############################</span>
<span class="c1">### Output the final plot </span>
<span class="c1">#############################</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plot.pdf&quot;</span><span class="p">)</span>   <span class="c1">### use this to save the figure in PDF format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>                <span class="c1">### output the combined plot plots</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Line is y = (</span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">slope_stdev</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">)x&quot;</span><span class="p">)</span>

<span class="n">line_slope</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="n">slope_stdev</span><span class="p">)</span>
<span class="n">calibration_factor</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">line_slope</span>
<span class="nb">print</span><span class="p">(</span><span class="n">line_slope</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calibration factor: </span><span class="si">{</span><span class="n">calibration_factor</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d44be074d9ab68b22f2a1b51770693a9a8c4f7862da482ef72209cdee087f970.png" src="../_images/d44be074d9ab68b22f2a1b51770693a9a8c4f7862da482ef72209cdee087f970.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Line is y = (5.88 +/- 0.12)x
5.88+/-0.12
Calibration factor: 0.170+/-0.004
</pre></div>
</div>
</div>
</div>
<p>The calibration factor shows that this diastereomer is a certain fraction of the total population of permethrins.  For example, if the factor was <span class="math notranslate nohighlight">\(0.28\)</span> then that given diastereomer is <span class="math notranslate nohighlight">\(28\%\)</span> of the total permethrin and the concentration of that disatereomer would be scaled accordingly.</p>
<p>We could have just used the ratio of the expected total peak area to the measured peak area of a disatereomer to get this factor but I chose to use a line fit which gives me the same result and but also serves to include all the experimental initial diastereomer peak areas. The curve fit function will report a standard deviation for the line fit that will be the error for this concentration adjustment factor.</p>
<p>There are other ways to to this.  I could have calculated the factor for each tube in the control lane and then averaged them to get mean and the standard deviation. either method is acceptable. the key point is that the approach I used above is documented. No matter how bad my explanation of what I did is, the <em>Python</em> code describes exactly what was done.</p>
<p>feel free to criticize my work. You can see what I did and make it better.</p>
</div>
<div class="section" id="calculating-parameters">
<h3>Calculating Parameters<a class="headerlink" href="#calculating-parameters" title="Permalink to this headline">#</a></h3>
<p>We have values for <span class="math notranslate nohighlight">\(V_{max}\)</span> and <span class="math notranslate nohighlight">\(K_M\)</span> for this disatereomer of permethrin with each of the two versions of <em>carboxyesterase</em>. The values are expressed in terms of how much of the permethrin stock solution is in each tube and the amount that the peak area was reduced after 3 hours. We can convert these values to more common concentration and rate units.</p>
<p>Examine the code below.  I am again using the <em>uncertainties</em> package to track error propagation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">KM1_mM</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat</span><span class="p">(</span><span class="n">KM1</span><span class="p">,</span><span class="n">KM1_stdev</span><span class="p">)</span>


<span class="c1">### KM = uL injected in reaction. Convert to mM.</span>
<span class="c1">### KM = uL * 1 L/10^6 uL * mol/L * 1/mL * 1000mL/L * n</span>

<span class="n">KM1_mM</span> <span class="o">=</span> <span class="p">(</span><span class="n">KM1_mM</span><span class="o">/</span><span class="mi">1000000</span><span class="p">)</span> <span class="o">*</span> <span class="n">conc_stock_soln</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">volume_reaction</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">calibration_factor</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For hCE1: KM = </span><span class="si">{</span><span class="n">KM1_mM</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> mM&quot;</span><span class="p">)</span>

<span class="n">KM2_mM</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat</span><span class="p">(</span><span class="n">KM2</span><span class="p">,</span><span class="n">KM2_stdev</span><span class="p">)</span>

<span class="n">KM2_mM</span> <span class="o">=</span> <span class="p">(</span><span class="n">KM2_mM</span><span class="o">/</span><span class="mi">1000000</span><span class="p">)</span> <span class="o">*</span> <span class="n">conc_stock_soln</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">volume_reaction</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">calibration_factor</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For hCE2: KM = </span><span class="si">{</span><span class="n">KM2_mM</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> mM&quot;</span><span class="p">)</span>

<span class="c1">### Vmax is in dArea/3 hours.  Convert to umoles/L.min</span>
<span class="c1">### Vmax = Area/3hr *1hr/60min * 1umole/640.09+/-32.18 Area * 1/0.0001 L</span>

<span class="n">Vmax1_uMmin</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat</span><span class="p">(</span><span class="n">Vmax1</span><span class="p">,</span><span class="n">Vmax1_stdev</span><span class="p">)</span>
<span class="n">Vmax1_uMmin</span> <span class="o">=</span> <span class="n">Vmax1_uMmin</span><span class="o">/</span><span class="mi">360</span><span class="o">/</span><span class="n">coeff</span><span class="o">/</span><span class="mf">0.0001</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For hCE1: Vmax = </span><span class="si">{</span><span class="n">Vmax1_uMmin</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> uM/min&quot;</span><span class="p">)</span>

<span class="n">Vmax2_uMmin</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat</span><span class="p">(</span><span class="n">Vmax2</span><span class="p">,</span><span class="n">Vmax2_stdev</span><span class="p">)</span>
<span class="n">Vmax2_uMmin</span> <span class="o">=</span> <span class="n">Vmax2_uMmin</span><span class="o">/</span><span class="mi">360</span><span class="o">/</span><span class="n">coeff</span><span class="o">/</span><span class="mf">0.0001</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For hCE1: Vmax = </span><span class="si">{</span><span class="n">Vmax2_uMmin</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> uM/min&quot;</span><span class="p">)</span>

<span class="n">Mol_Wt_Enz</span> <span class="o">=</span> <span class="mi">61800</span> <span class="c1"># g/mole</span>
<span class="n">Enz_Specific_Activity</span> <span class="o">=</span> <span class="mi">58000</span> <span class="c1"># units/mg</span>
<span class="n">Enz_Units</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1">#  10000 +/- 100 units</span>
<span class="n">Volume_Enz_Solution</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># 1000 +/- 10 uL</span>
<span class="n">Aliquote_Enz</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># 50 +/- 0.1 uL</span>

<span class="n">mass_enz</span> <span class="o">=</span> <span class="n">Enz_Units</span> <span class="o">/</span> <span class="n">Enz_Specific_Activity</span>
<span class="n">moles_enz</span> <span class="o">=</span> <span class="n">mass_enz</span> <span class="o">/</span> <span class="n">Mol_Wt_Enz</span> <span class="o">/</span><span class="mi">1000</span>
<span class="n">conc_Enz_Solution</span> <span class="o">=</span> <span class="n">moles_enz</span> <span class="o">/</span> <span class="p">(</span><span class="n">Volume_Enz_Solution</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1000000</span><span class="p">)</span> <span class="c1">### 1L/1000000uL</span>
<span class="n">Enz_Conc</span> <span class="o">=</span> <span class="n">conc_Enz_Solution</span> <span class="o">*</span> <span class="p">(</span><span class="n">Aliquote_Enz</span><span class="o">/</span><span class="mi">1000000</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">volume_reaction</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[E] = </span><span class="si">{</span><span class="n">Enz_Conc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">kcat1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Vmax1_uMmin</span><span class="o">/</span><span class="mi">1000000</span><span class="o">/</span><span class="mi">60</span><span class="p">)</span> <span class="o">/</span> <span class="n">Enz_Conc</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For hCE1: kcat = </span><span class="si">{</span><span class="n">kcat1</span><span class="si">:</span><span class="s2">0.4g</span><span class="si">}</span><span class="s2"> /s&quot;</span><span class="p">)</span>
<span class="n">kcat2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Vmax2_uMmin</span><span class="o">/</span><span class="mi">1000000</span><span class="o">/</span><span class="mi">60</span><span class="p">)</span> <span class="o">/</span> <span class="n">Enz_Conc</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For hCE2: kcat = </span><span class="si">{</span><span class="n">kcat2</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> /s&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For hCE1: kcat/KM = </span><span class="si">{</span><span class="n">kcat1</span><span class="o">/</span><span class="p">(</span><span class="n">KM1_mM</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> /s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For hCE2: kcat/KM = </span><span class="si">{</span><span class="n">kcat2</span><span class="o">/</span><span class="p">(</span><span class="n">KM3_mM</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> /s&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">kcat1</span><span class="o">/</span><span class="p">(</span><span class="n">KM1_mM</span><span class="o">/</span><span class="mi">1000</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">volume_reaction</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">KM1_mM</span> <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">ufloat</span><span class="p">(</span><span class="n">KM1</span><span class="p">,</span><span class="n">KM1_stdev</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1">### KM = uL injected in reaction. Convert to mM.</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="c1">### KM = uL * 1 L/10^6 uL * mol/L * 1/mL * 1000mL/L * n</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">KM1_mM</span> <span class="o">=</span> <span class="p">(</span><span class="n">KM1_mM</span><span class="o">/</span><span class="mi">1000000</span><span class="p">)</span> <span class="o">*</span> <span class="n">conc_stock_soln</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">volume_reaction</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">calibration_factor</span>

<span class="ne">NameError</span>: name &#39;un&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="rinse-and-repeat">
<h2>Rinse and Repeat<a class="headerlink" href="#rinse-and-repeat" title="Permalink to this headline">#</a></h2>
<p>There are four data sets, one for each peak in the HPLC chromatogram. We can alayze all four using this notebook. We can report the exact methiods used in data analysis by providing this notebook as the documentation. the code reveals what we did in precise detail. The truth is there for all to criticize or marvel.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Permethrin"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#curve-fits-with-errors-included">Curve Fits with Errors Included</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-load-data-and-calculate-means-and-errors">Step 1: Load data and calculate means and errors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-perform-curve-fit-with-errors">Step 2: Perform curve fit with errors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-plot-data-with-error-pars-and-line-fit">Step 3: Plot data with error pars and line fit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-4-and-5-do-it-all-again-with-hce2">Steps 4 and 5: Do It All Again with hCE2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-convert-to-preferred-units-and-track-errors">Step 4: Convert to preferred units and track errors</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notes-on-errors">Notes on Errors</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-initial-area-to-concentration">Converting Initial Area to Concentration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-parameters">Calculating Parameters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rinse-and-repeat">Rinse and Repeat</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Barry Linkletter
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
       Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>